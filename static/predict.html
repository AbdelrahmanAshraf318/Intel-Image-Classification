<!DOCTYPE html>
<html>
    <title>Greeting App</title>
    <style>
        *{
            font-size: 30px;
        }
    </style>
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <script src=
"https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js">
    </script>
    </head>
  <body>
    
    <input id="image-selector" type="file"/>
    <button id="predict-button">Predict</button>
    <p style="font-weight: bold;">Predictions</p>

    <p>Buildings: <span id="building-prediction"></span></p>
    <p>Forest: <span id="forest-prediction"></span></p>
    <p>Glacier: <span id="glacier-prediction"></span></p>
    <p>Mountain: <span id="mountain-prediction"></span></p>
    <p>Sea: <span id="sea-prediction"></span></p>
    <p>Street: <span id="street-prediction"></span></p>

    <img id="selected-image" src="" alt=""/>


    
    <script>

      let base64Image;
      $("#image-selector").change(function(){
        let reader = new FileReader();
        reader.onload = function(e){
          let dataURL = reader.result;
          $('#selected-image').attr("src", dataURL);
          base64Image = dataURL.replace("data:image/jpeg;base64,", '');
          console.log(base64Image);
        }
        reader.readAsDataURL($("#image-selector")[0].files[0]);
        $("#building-prediction").text("");
        $("#forest-prediction").text("");
        $("#glacier-prediction").text("");
        $("#mountain-prediction").text("");
        $("#sea-prediction").text("");
        $("#street-prediction").text("");
      });

      $("#predict-button").click(function(event){
        let message = {
          image: base64Image 
        }
        console.log(message);
        $.post("http://127.0.0.1:5000/predict", JSON.stringify(message), function(response){
          $("#building-prediction").text(response.prediction.Buildings.toFixed(6));
          $("#forest-prediction").text(response.prediction.Forest.toFixed(6));
          $("#glacier-prediction").text(response.prediction.Glacier.toFixed(6));
          $("#mountain-prediction").text(response.prediction.Mountain.toFixed(6));
          $("#sea-prediction").text(response.prediction.Sea.toFixed(6));
          $("#street-prediction").text(response.prediction.Street.toFixed(6));
          console.log(response);
        });
      });

    </script>

  </body>

</html>